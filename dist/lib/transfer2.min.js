webpackJsonp([17],{"7fJ5":function(module,exports){module.exports='<div class="ma-tree-select transition-none"\n  ng-disabled="disabled">\n  <div class="custom-multi-select form-control ui-select-container ui-select-multiple select2 select2-container select2-container-multi ng-isolate-scope ng-not-empty ng-valid custom-tree-select custom-static-select">\n\n    <div class="ui-select-dropdown select2-drop select2-with-searchbox select2-drop-active select2-display-none">\n      <div class="search-container select2-search">\n        <div class="ma-input ma-input-search-normal"\n          ng-disabled="disabled">\n          <input type="text"\n            autocomplete="off"\n            autocorrect="off"\n            autocapitalize="off"\n            spellcheck="false"\n            role="combobox"\n            aria-expanded="true"\n            aria-owns="ui-select-choices-0"\n            aria-label="Select box"\n            class="select2-input ui-select-search ng-pristine ng-valid ng-empty ng-touched"\n            ng-model="$ctrl.searchKey"\n            ng-disabled="disabled"\n            ondrop="return false;">\n        </div>\n      </div>\n      <ul tabindex="-1"\n        ng-class="{\'has-search\': $ctrl.searchKey}"\n        class="ui-select-choices ui-select-choices-content select2-results ng-scope">\n\n      </ul>\n    </div>\n  </div>\n</div>\n'},BWKA:function(module,exports){module.exports='<div class="ma-transfer">\n  <div class="fl">\n    <div class="ma-transfer-left-result">\n      <ma-checkbox ng-disabled="disabled"\n        ng-class="{\n          \'has-sub\': $ctrl.leftSub,\n        }"\n        ng-model="$ctrl.leftCheckbox">\n      </ma-checkbox>\n\n      <span class="ma-transfer-title">{{leftTitle || \'所有\'}}</span>\n    </div>\n    <ma-tree ng-disabled="disabled"\n      class="ma-transfer-left-tree"\n      ng-model="$ctrl.leftSelected"\n      ma-data="$ctrl.leftData"\n      ma-value-key="{{valueKey}}"\n      ma-sub-key="{{subKey}}"\n      ma-text-key="{{textKey}}"\n      ma-hide-items="$ctrl.leftHideItems"></ma-tree>\n  </div>\n  <div class="fl ma-transfer-center">\n    <div class="mb-20">\n      <ma-button ng-disabled="$ctrl.leftButtonDisabled"\n        ma-click="$ctrl.toRight($event)">\n        <span>添加</span>\n        <ma-icon ma-type="arrowright"></ma-icon>\n      </ma-button>\n    </div>\n    <div>\n      <ma-button ng-disabled="$ctrl.rightButtonDisabled"\n        ma-click="$ctrl.toLeft($event)">\n        <ma-icon ma-type="arrowleft"></ma-icon>\n        <span>删除</span>\n      </ma-button>\n    </div>\n  </div>\n  <div class="fl">\n    <div class="ma-transfer-right-result">\n      <ma-checkbox ng-disabled="disabled"\n        ng-class="{\n          \'has-sub\': $ctrl.rightSub,\n        }"\n        ng-model="$ctrl.rightCheckbox">\n      </ma-checkbox>\n\n      <span class="ma-transfer-title">{{rightTitle || \'选中\'}}</span>\n    </div>\n    <ma-tree ng-disabled="disabled"\n      class="ma-transfer-right-tree"\n      ng-model="$ctrl.rightSelected"\n      ma-data="$ctrl.rightData"\n      ma-value-key="{{valueKey}}"\n      ma-sub-key="{{subKey}}"\n      ma-text-key="{{textKey}}"\n      ma-show-items="$ctrl.rightShowItems"></ma-tree>\n  </div>\n</div>\n'},e2Tx:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _name=__webpack_require__("pL48"),_name2=function(obj){return obj&&obj.__esModule?obj:{"default":obj}}(_name);angular.module(_name2["default"],[]).config(function(){}).run(function(){}),__webpack_require__("xEAJ"),__webpack_require__("s87f"),exports["default"]=_name2["default"]},oXUz:function(module,exports){module.exports=' {{each data}}\n {{if !$value._parent || renderSub}}\n<li class="ui-select-choices-row tree-level-{{$value._level}} {{$value._sub ? \'has-sub\': \'\'}}"\n  data-value="{{$value[valueKey]}}"\n  data-from="{{$value._from}}"\n  data-to="{{$value._to}}">\n  <div class="select2-result-label ui-select-choices-row-inner">\n    <div>\n      {{if $value._sub}}\n      <i class="tree-arrow-click">\n        <i class="tree-arrow"></i>\n      </i>\n      {{/if}}\n      \x3c!-- <div class="click-mask"></div> --\x3e\n      <label class="ma-checkbox">\n        <input type="checkbox" />\n        <i class="ma-checkbox-appearance"></i>\n        <span>{{$value[textKey]}}</span>\n      </label>\n    </div>\n  </div>\n</li>\n{{/if}}\n{{/each}}\n'},pL48:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]="meetyou.angular.ui.transfer2"},s87f:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function maTreeTransfer2(){return{restrict:"E",replace:!0,scope:{data:"=maData",model:"=ngModel",maModel:"=maModel",valueKey:"@maValueKey",textKey:"@maTextKey",subKey:"@maSubKey",disabled:"=ngDisabled",leftTitle:"@maLeftTitle",rightTitle:"@maRightTitle"},template:_maTreeTransfer2Tpl2["default"],controllerAs:"$ctrl",controller:["$scope","$element","$attrs",function($scope,$element,$attrs){function updateLeftSub(){updateSub("left")}function updateRightSub(){updateSub("right")}function updateSub(direction){var level0Items=(0,_jquery2["default"])($element).find(".ma-transfer-"+direction+"-tree.ma-tree-select .tree-level-0"),level0Values=[],selected=$ctrl[direction+"Selected"]||[],count=0,len=0;level0Items.each(function(){(0,_jquery2["default"])(this).hasClass("hidden")||level0Values.push((0,_jquery2["default"])(this).attr("data-value"))}),level0Values.forEach(function(d){-1!==selected.indexOf(d)&&count++,len++}),len>0&&($ctrl[direction+"Sub"]=count>0&&count<len,count===len?!1===$ctrl[direction+"Checkbox"]&&($ctrl[direction+"Checkbox"]=!0,$scope.isSelectedChangeCheckbox=!0):!0===$ctrl[direction+"Checkbox"]&&($ctrl[direction+"Checkbox"]=!1,$scope.isSelectedChangeCheckbox=!0))}function toRight(){$scope.$broadcast("search.clear"),angular.isNull($scope.model)&&($scope.model=[]),$scope.model=$scope.model.concat($ctrl.leftSelected),$ctrl.leftSelected=[],$ctrl.rightSelected=[],$ctrl.leftCheckbox=!1,$ctrl.rightCheckbox=!1}function toLeft(){$scope.$broadcast("search.clear"),angular.isNull($scope.model)&&($scope.model=[]);var oldModel=getModelWidthChild(),newModel=[],selectWithChild=getSelectedWithChild();angular.each(oldModel,function(d){-1===selectWithChild.indexOf(d)&&newModel.push(d)}),$scope.model=newModel,$ctrl.leftSelected=[],$ctrl.rightSelected=[],$ctrl.leftCheckbox=!1,$ctrl.rightCheckbox=!1}function getModelWidthChild(){function getSub(items){angular.each(items,function(d){-1!==model.indexOf(d[$scope.valueKey]+"")?d[$scope.subKey]&&d[$scope.subKey].length?pushSub(d[$scope.subKey]):newModel.push(d[$scope.valueKey]+""):getSub(d[$scope.subKey])})}function pushSub(items){angular.each(items,function(d){d[$scope.subKey]&&d[$scope.subKey].length?pushSub(d[$scope.subKey]):newModel.push(d[$scope.valueKey]+"")})}var model=$scope.model||[],newModel=[];return getSub($scope.data),newModel}function getSelectedWithChild(){function checkSub(items){angular.each(items,function(d){var sub=d[$scope.subKey];-1!==selected.indexOf(d[$scope.valueKey]+"")&&sub&&sub.length?pushSub(sub):sub&&sub.length&&checkSub(sub)})}function pushSub(sub){angular.each(sub,function(dd){newSelected.push(dd[$scope.valueKey]+""),dd[$scope.subKey]&&dd[$scope.subKey].length&&pushSub(dd[$scope.subKey])})}var newSelected=[],selected=$ctrl.rightSelected||[];return checkSub($scope.data),selected.concat(newSelected)}function filterChild(){function checkSub(items){var subInLen=0;return angular.forEach(items,function(d){if(-1!==selected.indexOf(d[$scope.valueKey]+""))newModel.push(d[$scope.valueKey]+""),subInLen++;else{var sub=d[$scope.subKey];if(sub&&sub.length){checkSub(sub)>=sub.length&&(newModel.push(d[$scope.valueKey]+""),angular.each(sub,function(s){-1!==newModel.indexOf(s[$scope.valueKey]+"")&&newModel.splice(newModel.indexOf(s[$scope.valueKey]+""),1)}))}}}),subInLen}var selected=$scope.model||[],newModel=[],sameCount=0;return checkSub($scope.data),newModel.forEach(function(d){-1!==selected.indexOf(d)&&sameCount++}),sameCount<selected.length&&newModel}function updateLeftRigthData(){var leftData=_jquery2["default"].extend(!0,[],$scope.data),rightData=_jquery2["default"].extend(!0,[],$scope.data);$ctrl.leftData=leftData,$ctrl.rightData=rightData}function getParentAndChild(selected){function get(items){angular.each(items,function(item){if(-1!==selected.indexOf(item[$scope.valueKey]+"")){var cItem=item;for(newSelected.push(item[$scope.valueKey]+"");cItem._parent;)-1===newSelected.indexOf(cItem._parent[$scope.valueKey]+"")&&newSelected.push(cItem._parent[$scope.valueKey]+""),cItem=cItem._parent;getSub(item[$scope.subKey])}item[$scope.subKey]&&item[$scope.subKey].length&&get(item[$scope.subKey])})}function getSub(sub){sub&&sub.length&&angular.each(sub,function(item){newSelected.push(item[$scope.valueKey]+""),getSub(item[$scope.subKey])})}var newSelected=[];return get($ctrl.leftData),newSelected}var $ctrl=this;$ctrl.searchKey="",$ctrl.leftSub=!1,$ctrl.leftCheckbox=!1,$ctrl.leftButtonDisabled=!0,$ctrl.rightButtonDisabled=!0,$ctrl.rightSub=!1,$ctrl.rightCheckbox=!1,$ctrl.toRight=toRight,$ctrl.toLeft=toLeft,$ctrl.leftSelected=[],$ctrl.rightSelected=[],$ctrl.leftData=[],$ctrl.rightData=[],$ctrl.leftHideItems=[],$ctrl.rightShowItems=[],$scope.$watch("data",function(d){updateLeftRigthData()}),$scope.$watch("model",function(d){var newModel=filterChild();if(newModel)return void($scope.model=newModel);$ctrl.leftHideItems=d||[],$ctrl.rightShowItems=d||[],$attrs.maModel&&($scope.maModel=getParentAndChild(d))}),$scope.$watch("$ctrl.leftCheckbox",function(d){if($scope.isSelectedChangeCheckbox)return void($scope.isSelectedChangeCheckbox=!1);!0===d&&($ctrl.leftSelected="all"),!1===d&&($ctrl.leftSelected=[])}),$scope.$watch("$ctrl.rightCheckbox",function(d){if($scope.isSelectedChangeCheckbox)return void($scope.isSelectedChangeCheckbox=!1);!0===d&&($ctrl.rightSelected="all"),!1===d&&($ctrl.rightSelected=[])}),$scope.$watch("$ctrl.leftSelected",function(d){$ctrl.leftButtonDisabled=!(d&&d.length),updateLeftSub()}),$scope.$watch("$ctrl.rightSelected",function(d){$ctrl.rightButtonDisabled=!(d&&d.length),updateRightSub()})}],link:function(scope,element,attrs,ctrl){scope.textKey=attrs.maTextKey||"text",scope.valueKey=attrs.maValueKey||"value",attrs.$observe("maTextKey",function(d){scope.textKey=d||"text"}),attrs.$observe("maValueKey",function(d){scope.valueKey=d||"value"})}}}var _name=__webpack_require__("pL48"),_name2=_interopRequireDefault(_name),_jquery=__webpack_require__("7t+N"),_jquery2=_interopRequireDefault(_jquery),_maTreeTransfer2Tpl=__webpack_require__("BWKA"),_maTreeTransfer2Tpl2=_interopRequireDefault(_maTreeTransfer2Tpl);angular.module(_name2["default"]).directive("maTreeTransfer2",maTreeTransfer2),maTreeTransfer2.$inject=[]},xEAJ:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function maTree(){return{restrict:"E",replace:!0,scope:{data:"=maData",model:"=ngModel",valueKey:"@maValueKey",textKey:"@maTextKey",subKey:"@maSubKey",disabled:"=ngDisabled",showItems:"=maShowItems",hideItems:"=maHideItems"},template:_maTreeTpl2["default"],controllerAs:"$ctrl",controller:["$scope","$element",function($scope,$element){function expandMatch(searchKey){function doExpand(){expands.forEach(function(d){var arrow=contentTarget.find(itemCls+'[data-to="'+d+'"] .tree-arrow-click');arrow.length?arrow.parent().hasClass("tree-open")||arrow.trigger("click"):unexpand.push(d)}),expands=unexpand,unexpand=[],expands.length&&doExpand()}if(contentTarget.find(".search-match").removeClass("search-match"),!angular.isNull(searchKey)){var expands=[],unexpand=[];$scope.newItems.forEach(function(d){var item=d;if(-1!==(item[$scope.textKey]+"").indexOf(searchKey)&&item._from)for(expands.push(item._from);item._parent&&item._parent._from;)expands.push(item._parent._from),item=item._parent}),doExpand(),$scope.newItems.forEach(function(d){-1!==(d[$scope.textKey]+"").indexOf(searchKey)&&contentTarget.find(itemCls+'[data-value="'+d[$scope.valueKey]+'"]').addClass("search-match")})}}function updateDisabled(){$scope.disabled?contentTarget.find("input, .ma-checkbox").attr("disabled",!0):contentTarget.find("input, .ma-checkbox").attr("disabled",!1)}function renderContent(data){var items=(0,_jquery2["default"])(_templateWeb2["default"].render(_itemTpl2["default"],{data:data,textKey:$scope.textKey,valueKey:$scope.valueKey}));bindEvent(items),contentTarget.html(items),updateHideShow()}function updateHideShow(){if($scope.hideItems){var parents=getParents($scope.hideItems),childs=getChilds($scope.hideItems);contentTarget.find(itemCls).removeClass("hidden"),$scope.hideItems.forEach(function(d){var value=angular.isObject(d)?d[$scope.valueKey]+"":d;contentTarget.find(itemCls+'[data-value="'+value+'"]').addClass("hidden")}),childs.forEach(function(d){contentTarget.find(itemCls+'[data-value="'+d+'"]').addClass("hidden")}),parents.forEach(function(d){contentTarget.find(itemCls+'[data-value="'+d+'"]').removeClass("hidden")})}if($scope.showItems){var _parents=getParents($scope.showItems),_childs=getChilds($scope.showItems);contentTarget.find(itemCls).addClass("hidden"),$scope.showItems.forEach(function(d){var value=angular.isObject(d)?d[$scope.valueKey]+"":d;contentTarget.find(itemCls+'[data-value="'+value+'"]').removeClass("hidden")}),_parents.concat(_childs).forEach(function(d){contentTarget.find(itemCls+'[data-value="'+d+'"]').removeClass("hidden")})}}function getChilds(itemValues){function getChild(item){var sub=item[$scope.subKey];sub&&sub.length&&sub.forEach(function(d){childs.push(d[$scope.valueKey]+""),getChild(d)})}var childs=[];return angular.each($scope.newItems,function(d){-1!==itemValues.indexOf(d[$scope.valueKey]+"")&&getChild(d)}),childs}function getParents(itemValues){var parents=[];return angular.each($scope.newItems,function(d){if(-1!==itemValues.indexOf(d[$scope.valueKey]+""))for(var item=d;item._parent;)parents.push(item._parent[$scope.valueKey]+""),item=item._parent}),parents}function toggleTree(e){if(!$scope.disabled){var target=(0,_jquery2["default"])(e.target),item=target.parents(itemCls),to=item.attr("data-to"),froms=contentTarget.find(itemCls+'[data-from="'+to+'"]'),fromChilds=contentTarget.find(itemCls+'[data-from*="'+to+'_"]');froms.length?(froms.toggleClass("hide"),fromChilds.toggleClass("child-hide")):(froms=(0,_jquery2["default"])(_templateWeb2["default"].render(_itemTpl2["default"],{data:subStore[to],textKey:$scope.textKey,valueKey:$scope.valueKey,renderSub:!0})),froms.insertAfter(item),bindEvent(froms,item),updateHideShow()),target.parent().toggleClass("tree-open")}}function bindEvent(items,parent){items.find(".tree-arrow-click").on("click",toggleTree),items.find('input[type="checkbox"]').on("change",function(e){checkedSub((0,_jquery2["default"])(e.target).parents(itemCls).attr("data-to"),e.target.checked),checkedParent((0,_jquery2["default"])(e.target).parents(itemCls).attr("data-from"),e.target.checked),updateModel()}),parent&&checkedSub(parent.attr("data-to"),parent.find("input").prop("checked")),updateDisabled()}function updateModel(){var newModel=[];contentTarget.find("input:checked").each(function(){var item=(0,_jquery2["default"])(this).parents(itemCls),from=item.attr("data-from");return contentTarget.find(itemCls+'[data-to="'+from+'"]').attr("data-value"),!!hasParentSelected(item)||(newModel.push(item.attr("data-value")),!0)}),$scope.$applyAsync(function(){$scope.model=newModel})}function hasParentSelected(item){var from=item.attr("data-from"),parent=contentTarget.find(itemCls+'[data-to="'+from+'"]'),ret=!1;return ret=!!(from&&parent.length&&parent.find("input").prop("checked")),!1===ret&&from&&parent.attr("data-from")&&(ret=hasParentSelected(parent)),ret}function checkedSub(to,checked){if(to){var items=contentTarget.find(itemCls+'[data-from="'+to+'"]'),item=contentTarget.find(itemCls+'[data-to="'+to+'"]');items.each(function(){(0,_jquery2["default"])(this).hasClass("hidden")||((0,_jquery2["default"])(this).find("input").prop("checked",checked),checkedSub((0,_jquery2["default"])(this).attr("data-to"),checked))}),item.find(".ma-checkbox").removeClass("has-sub")}}function checkedParent(from){if(from){var items=contentTarget.find(itemCls+'[data-to="'+from+'"]'),maCheckbox=items.find(".ma-checkbox"),data=getSubCheckedCount(from);maCheckbox.removeClass("has-sub"),data.count<=0?(items.find("input").prop("checked",!1),data.sub&&maCheckbox.addClass("has-sub")):data.count>=data.total?items.find("input").prop("checked",!0):(items.find("input").prop("checked",!1),maCheckbox.addClass("has-sub")),checkedParent(items.attr("data-from"))}}function getSubCheckedCount(from){var items=contentTarget.find(itemCls+'[data-from="'+from+'"]'),count=0,total=0,sub=0;return items.each(function(){(0,_jquery2["default"])(this).hasClass("hidden")||((0,_jquery2["default"])(this).find("input").prop("checked")&&count++,(0,_jquery2["default"])(this).find(".ma-checkbox").hasClass("has-sub")&&sub++,total++)}),{total:total,count:count,sub:sub}}function updateTree(items){function getSub(items,parentItem,treeLevel){angular.each(items,function(d){var item=d;newItems.push(item),item._level=treeLevel,item[subKey]&&item[subKey].length&&(item.tagId=parentItem?parentItem.tagId+"_"+angular.uuid():"tag_"+angular.uuid(),item._to=item.tagId,item._sub=!0,subStore[item.tagId]=item[subKey],angular.forEach(item[subKey],function(it){it._parent=item,it._from=item.tagId}),getSub(item[subKey],item,treeLevel+1))})}var newItems=[],subKey=$scope.subKey;return subStore={},getSub(items,null,0),newItems}var $ctrl=this,contentTarget=(0,_jquery2["default"])($element).find(".ui-select-choices-content"),itemCls=".ui-select-choices-row",subStore={};$ctrl.searchKey="",$scope.$on("search.clear",function(){$ctrl.searchKey=""}),$scope.$watch("$ctrl.searchKey",function(d){expandMatch(d)}),$scope.$watch("disabled",updateDisabled),$scope.$watch("data",function(d){var items=updateTree(d);$scope.newItems=items,renderContent(items)}),$scope.$watch("showItems",function(d){d&&updateHideShow()}),$scope.$watch("hideItems",function(d){d&&updateHideShow()}),$scope.$watch("model",function(d){if(angular.isEmpty(d)&&(contentTarget.find(itemCls).each(function(){(0,_jquery2["default"])(this).find("input").prop("checked",!1)}),contentTarget.find(".ma-checkbox").removeClass("has-sub")),"all"===d){var newModel=[];contentTarget.find(itemCls).each(function(){(0,_jquery2["default"])(this).hasClass("hidden")||((0,_jquery2["default"])(this).find("input").prop("checked",!0),newModel.push((0,_jquery2["default"])(this).attr("data-value")))}),contentTarget.find(".ma-checkbox").removeClass("has-sub"),$scope.model=newModel}})}],link:function(scope,element,attrs,ctrl){scope.textKey=attrs.maTextKey||"text",scope.valueKey=attrs.maValueKey||"value",attrs.$observe("maTextKey",function(d){scope.textKey=d||"text"}),attrs.$observe("maValueKey",function(d){scope.valueKey=d||"value"})}}}var _name=__webpack_require__("pL48"),_name2=_interopRequireDefault(_name),_templateWeb=__webpack_require__("H+C6"),_templateWeb2=_interopRequireDefault(_templateWeb),_jquery=__webpack_require__("7t+N"),_jquery2=_interopRequireDefault(_jquery),_maTreeTpl=__webpack_require__("7fJ5"),_maTreeTpl2=_interopRequireDefault(_maTreeTpl),_itemTpl=__webpack_require__("oXUz"),_itemTpl2=_interopRequireDefault(_itemTpl);angular.module(_name2["default"]).directive("maTree",maTree),maTree.$inject=[]}},["e2Tx"]);
//# sourceMappingURL=transfer2.min.js.map